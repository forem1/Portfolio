<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <title>Склад</title>
        <meta content="width=device-width, initial-scale=1" name="viewport">
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" type="text/css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <link href="../static/css/common.css" th:href="@{/css/common.css}" rel="stylesheet" />
        <script type="text/javascript" th:src="@{/js/common.js}"></script>
    </head>
    <body>

        <!-- Modals  section -->
        <!-- Add component -->
        <div class="modal fade" id="ComponentAdd" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Новый компонент</h5>
                    </div>
                    <div class="modal-body">
                        <label style="font-weight: normal; padding-right: 10px;">Наименование</label><input class="modal-parameter-input" id="ComponentFieldAddName"><br>
                        <label style="font-weight: normal; padding-right: 10px;">Полное наименование</label><input class="modal-parameter-input" id="ComponentFieldAddFullName"><br>
                        <label style="font-weight: normal; padding-right: 10px;">Серийный номер</label><input class="modal-parameter-input" id="ComponentFieldAddSerial"><br>
                        <label style="font-weight: normal; padding-right: 10px;">Количество</label><input class="modal-parameter-input" id="ComponentFieldAddAmount"><input class="modal-parameter-input" style="width: 125px;" id="ComponentFieldAddUnit"><br>
                        <label style="font-weight: normal; padding-right: 10px;">Расположение</label><input class="modal-parameter-input" id="ComponentFieldAddLocation"><br>
                        <label style="font-weight: normal; padding-right: 10px;">Тег</label><input class="modal-parameter-input" id="ComponentFieldAddTag"><br>
                        <label style="font-weight: normal; padding-right: 10px;">Группа</label>
                        <select class="form-control" id="ComponentFieldAddGroup">
                            [(${SelectComponent})]
                        </select><br>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="button" class="btn btn-primary component-info-add">Добавить</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add class -->
            <div class="modal fade" id="GeneralAddClass" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Новый класс</h5>
                        </div>
                        <div class="modal-body">
                            <label style="font-weight: normal; padding-right: 10px;">Наименование</label><input type="text" required class="modal-parameter-input" id="ClassFieldAddName"><br>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                            <button type="submit" id="TreeClassAdd" class="btn btn-primary tree-class-add">Добавить</button>
                        </div>
                    </div>
                </div>
            </div>

        <!-- Add category -->
        <div class="modal fade" id="GeneralAddCategory" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Новая категория</h5>
                    </div>
                    <div class="modal-body">
                        <label style="font-weight: normal; padding-right: 10px;">Наименование</label><input class="modal-parameter-input" id="CategoryFieldAddName"><br>
                        <label style="font-weight: normal; padding-right: 10px;">Класс</label><select id="CategoryFieldAddClass" class="form-control">
                        [(${SelectCategory})]
                    </select>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="button" id="TreeCategoryAdd" class="btn btn-primary tree-category-add">Добавить</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add group -->
        <div class="modal fade" id="GeneralAddGroup" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Новая группа</h5>
                    </div>
                    <div class="modal-body">
                        <label style="font-weight: normal; padding-right: 10px;">Наименование</label><input class="modal-parameter-input" id="GroupFieldAddName"><br>
                        <label style="font-weight: normal; padding-right: 10px;">Категория</label><select id="GroupFieldAddCategory" class="form-control">
                        [(${SelectGroup})]
                    </select>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="button" id="TreeGroupAdd" class="btn btn-primary tree-group-add">Добавить</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add transaction -->
        <div class="modal fade" id="TransactionAdd" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Новая транзакция</h5>
                    </div>
                    <div class="modal-body">
                        <label style="font-weight: normal; padding-right: 10px;">Id компонента</label><input class="modal-parameter-input" id="TransactionFieldAddId" readonly><br>
                        <label style="font-weight: normal; padding-right: 10px;">Дата</label><input type="date" class="modal-parameter-input" id="TransactionFieldAddDate"><br>
                        <label style="font-weight: normal; padding-right: 10px;">Разница</label><input class="modal-parameter-input" id="TransactionFieldAddDifferent"><br>
                        <label class="control-label" style="font-weight: normal; padding-right: 10px;">Сотрудник</label>
                        <select id="TransactionFieldAddStaff" class="form-control">
                            [(${SelectStaff})]
                        </select>
                        <label style="font-weight: normal; padding-right: 10px;">Цель</label><input class="modal-parameter-input" id="TransactionFieldAddPlace"><br>
                        <label style="font-weight: normal; padding-right: 10px;">Примечание</label><input class="modal-parameter-input" id="TransactionFieldAddNote"><br>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="button" class="btn btn-primary transaction-add-confirm">Добавить</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modals  section -->
        <form th:action="@{/logout}" method="post">
            <input type="submit" class="btn btn-danger" value="Выйти" style="position: absolute; right: 10px;">
        </form>
        <input style="position: absolute; top: 10px; width: 100%;" type="text" name="" id="Search" placeholder="Поиск...">
        <div class="tabs">
            <input checked id="tab-btn-1" name="tab-btn" type="radio" value=""> <label for="tab-btn-1">Склад</label> <input id="tab-btn-2" name="tab-btn" type="radio" value=""> <label for="tab-btn-2">Приход/Расход</label>
            <div id="content-1" style="position: absolute;">
                <p>
                    <button id="tree-expand-all" class="btn btn-primary">Развернуть все</button>
                    <button style="left: 10px; position: relative;" id="tree-collapse-all" class="btn btn-primary">Свернуть все</button>
                <div class="dropdown show">
                    <button class="btn btn-primary dropdown-toggle"id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="">Добавить</button>

                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                        <button style="position: relative; width: 100%;" class="btn btn-primary dropdown-item" data-toggle='modal' data-target="#ComponentAdd">Компонент</button><br>
                        <button style="position: relative; width: 100%; top: 3px;" class="btn btn-primary dropdown-item" data-toggle='modal' data-target="#GeneralAddGroup">Группу</button><br>
                        <button style="position: relative; width: 100%; top: 5px;" class="btn btn-primary dropdown-item" data-toggle='modal' data-target="#GeneralAddCategory">Категорию</button><br>
                        <button style="position: relative; width: 100%; top: 7px;" class="btn btn-primary dropdown-item" data-toggle='modal' data-target="#GeneralAddClass">Класс</button><br>
                    </div>
                </div>
                </p>
                <ul id="tree">
                    [(${ComponentsTree})]
                </ul>
            </div>
            <div id="content-2" style="position: absolute;">


                <table class="table" id="TransactionsTable">
                    <thead>
                    <tr>
                        <th scope="col">Дата</th>
                        <th scope="col">Id компонента</th>
                        <th scope="col">Разница</th>
                        <th scope="col">Id Сотрудника</th>
                        <th scope="col">Цель</th>
                        <th scope="col">Примечание</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- Asynchronous data filling -->
                    </tbody>
                </table>
            </div>
        </div>
        <script type="text/javascript"> //Поиск
        var TreeElem = document.getElementById("tree").getElementsByTagName("li");

        $("#Search").keypress(function(event){
            console.log(String.fromCharCode(event.which));

            //$('#tree-expand-all').trigger('click');

            for (i = 0; i < TreeElem.length; i++) {
                if (TreeElem[i].innerText.toLowerCase().indexOf($("#Search").val().toLowerCase()) > -1 && $("#Search").val().length > 0) {
                    //TreeElem[i].style.border = "1px solid red";
                    TreeElem[i].style.display = "block";
                }
                else {
                    //TreeElem[i].style.border = "none";
                    TreeElem[i].style.display = "none";
                }

                if ($("#Search").val() == '') {
                    TreeElem[i].style.display = "block";
                }
                //console.log(TreeElem[i].innerText);
            }
            //alert($("#Search").val());
        }).on('keydown', function(e) {
            if (e.keyCode==8) $('#Search').trigger('keypress');
        });
        </script>
    </body>
</html>